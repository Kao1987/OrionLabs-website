import { createApp } from "vue";
import { createPinia } from "pinia";

// Bootstrap 5 導入
import "bootstrap/dist/css/bootstrap.min.css";
import "bootstrap-icons/font/bootstrap-icons.css";
import "bootstrap";

import App from "./App.vue";
import router from "./router";

// === Orion 統一 CSS 架構系統 (Phase 4 性能優化) ===
// 遵循 D-style 規範：@layer 管理層級，降低 !important 使用
// 遵循 C-refactor 規範：最小化 HTTP 請求，優化載入性能

// 1. CSS 層級系統（最優先載入，管理特異性）
import "./assets/css/orion-layer-system.css"; // 🎯 CSS Layer 架構系統

// 2. 統一主題系統（合併 9 個主題檔案，減少 HTTP 請求）
import "./assets/css/orion-consolidated-theme.css"; // 🎯 統一主題系統 - 369 個 CSS 變數

// 3. 關鍵 CSS 檔案（無法合併）
import "./assets/utilities.css"; // 🛠️ 工具類
import "./assets/css/contrast-enhancements.css"; // 🎯 WCAG 對比度增強

// 4. 向後相容支持（逐步深度 Deprecated）
import "./assets/global.css"; // ⚠️ 向後相容，將逐步移除

// 5. Bootstrap 覆蓋層（必要的 !important 使用）
import "./assets/css/bootstrap-overrides.css"; // 🎯 Bootstrap 覆蓋（@layer overrides）

// === 主題驗證工具 (開發環境) ===
import { runThemeConsistencyCheck } from "./utils/themeValidator";

console.log("main.ts loaded with optimized CSS architecture (Phase 4)");

const app = createApp(App);

app.use(createPinia());
app.use(router);

// 掛載應用
app.mount("#app");

// === 主題一致性檢查 (開發環境限定) ===
if (import.meta.env.DEV) {
  // 確保 DOM 完全載入後才執行檢查
  setTimeout(() => {
    runThemeConsistencyCheck();
  }, 100);
}

console.log("Vue app mounted with Phase 4 CSS optimization");